{% extends 'base.html' %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="mb-12">
        <a href="{{ url_for('index') }}"
            class="inline-flex items-center gap-2 text-sm uppercase tracking-widest opacity-40 hover:opacity-100 transition-soft">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg>
            Back to Collection
        </a>
    </div>

    <div class="paper-texture p-12 md:p-20 shadow-2xl relative overflow-hidden">
        <!-- Decorative corner -->
        <div class="absolute top-0 right-0 w-32 h-32 opacity-5 pointer-events-none">
            <svg viewBox="0 0 100 100" class="w-full h-full text-black">
                <path d="M0,0 L100,0 L100,100 Z" fill="currentColor" />
            </svg>
        </div>

        <div class="flex flex-col md:flex-row gap-16 relative">
            <div class="w-full md:w-1/3 flex-shrink-0">
                <div class="vintage-border p-1 shadow-2xl rotate-1">
                    <div class="aspect-[2/3] overflow-hidden bg-stone-200">
                        {% if book.thumbnail %}
                        <img src="{{ book.thumbnail }}" alt="{{ book.title }}" class="w-full h-full object-cover">
                        {% else %}
                        <div class="w-full h-full flex items-center justify-center italic opacity-30 text-center p-8">
                            Manuscript without illustration</div>
                        {% endif %}
                    </div>
                </div>

                <div class="mt-12 space-y-6 pt-8 border-t border-black/5">
                    <div>
                        <span class="text-[10px] uppercase tracking-widest opacity-40 block mb-1">Catalog Status</span>
                        <span
                            class="text-sm font-bold uppercase tracking-widest px-2 py-0.5 border border-black/10 inline-block">
                            {{ 'Currently Reading' if book.status == 'reading' else 'Completed Voyage' }}
                        </span>
                    </div>
                    <div>
                        <span class="text-[10px] uppercase tracking-widest opacity-40 block mb-1">Date Logged</span>
                        <span class="italic">{{ book.date_added.strftime('%B %d, %Y') }}</span>
                    </div>
                    {% if book.date_finished %}
                    <div>
                        <span class="text-[10px] uppercase tracking-widest opacity-40 block mb-1">Date Completed</span>
                        <span class="italic">{{ book.date_finished.strftime('%B %d, %Y') }}</span>
                    </div>
                    {% endif %}
                    {% if book.categories %}
                    <div>
                        <span class="text-[10px] uppercase tracking-widest opacity-40 block mb-1">Classification</span>
                        <span class="text-xs uppercase tracking-widest opacity-60">{{ book.categories }}</span>
                    </div>
                    {% endif %}
                </div>
            </div>

            <div class="flex-1 space-y-10">
                <header>
                    <h2 class="text-5xl font-bold leading-tight mb-4 text-emerald-950">{{ book.title }}</h2>
                    <p class="text-2xl italic opacity-70">by {{ book.authors or 'Anonymous' }}</p>
                </header>

                <div class="prose prose-stone max-w-none">
                    <div class="h-px w-20 bg-emerald-900/20 mb-10"></div>
                    <div
                        class="text-xl leading-relaxed italic opacity-80 first-letter:text-5xl first-letter:font-bold first-letter:mr-3 first-letter:float-left first-letter:mt-1">
                        {% if book.description %}
                        {{ book.description|safe }}
                        {% else %}
                        <p class="opacity-40 italic">No description has been recorded for this volume yet.</p>
                        {% endif %}
                    </div>
                </div>

                {% if current_user.is_authenticated %}
                <div class="pt-12 flex gap-6">
                    {% if book.status == 'reading' %}
                    <form action="{{ url_for('finish_book', book_id=book.id) }}" method="POST">
                        <button type="submit"
                            class="bg-emerald-900 text-stone-100 px-8 py-3 uppercase tracking-widest font-bold hover:bg-emerald-800 transition-soft shadow-lg">
                            Close Chapter
                        </button>
                    </form>
                    {% endif %}
                    <form action="{{ url_for('delete_book', book_id=book.id) }}" method="POST"
                        onsubmit="return confirm('Are you sure you wish to remove this volume from the archives?');">
                        <button type="submit"
                            class="border border-red-900/20 text-red-900/60 hover:text-red-900 hover:border-red-900/40 px-6 py-3 uppercase tracking-widest font-bold text-xs transition-soft">
                            Discard Volume
                        </button>
                    </form>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Bottom signature style decoration -->
        <div class="mt-20 text-right opacity-10 font-serif italic text-2xl">
            Alexandria Archives
        </div>
    </div>
</div>
{% endblock %}